<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSC Adherence Timer</title>
    <meta name="theme-color" content="#007bff">
    <link rel="manifest" href="./manifest.webmanifest">
    <link rel="stylesheet" href="./styles.css">
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <script src="./script.js" defer></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body class="dark">
    <nav class="top-navbar">
        <div class="title-container">
            <img src="./logo.png" alt="Logo" class="logo" onerror="this.style.display='none';">
            <h1>CSC Adherence Timer</h1>
        </div>
        <select id="profileSwitcher" class="profile-switcher">
            <option value="default">Default Schedule</option>
            <option value="monday">Monday Schedule</option>
            <option value="weekend">Weekend</option>
        </select>
        <button id="addSchedule" class="tooltip"><i class="fas fa-plus"></i><span class="tooltip-text">Add Schedule</span></button>
        <div id="newScheduleInput" style="display: none;">
            <input type="text" id="newProfileInput" placeholder="New Schedule Name">
            <button id="confirmAddProfile">Confirm</button>
            <button id="cancelAddProfile">Cancel</button>
        </div>
        <button id="toggleSettings" class="tooltip">Show/Hide Settings<span class="tooltip-text">Toggle settings panel</span></button>
        <button id="muteAll" class="tooltip" style="display: none;">Mute All<span class="tooltip-text">Mute all sounds instantly</span></button>
    </nav>

    <div class="time-container">
        <span class="highlight clock" id="currentTime">Loading time...</span>
    </div>

    <div class="highlight countdown-container">
        <span class="icon">ðŸ•’</span> <span class="countdown-label">Countdown to next event:</span> <span id="countdown" class="countdown-text">--</span>
    </div>

    <div class="highlight status-container">
        <span class="status-icon"></span> Current Expected Status: <span id="expectedStatus">None</span>
    </div>

    <button id="managerEscalation" class="tooltip">Activate Manager Escalation<span class="tooltip-text">Pauses audible alerts except for break and meal</span></button>
    <h3>Current Status</h3>
    <p>Click the button matching your current work status to acknowledge and reset the clock color.</p>

    <div class="status-buttons">
        <button class="status" data-type="On Queue"><i class="fas fa-phone"></i> On Queue</button>
        <button class="status" data-type="Available"><i class="fas fa-sign-out-alt"></i> Available</button>
        <button class="status" data-type="Break"><i class="fas fa-coffee"></i> Break</button>
        <button class="status" data-type="Meal"><i class="fas fa-utensils"></i> Meal</button>
        <button class="status" data-type="Meeting"><i class="fas fa-users"></i> Meeting</button>
        <button class="status" data-type="Busy"><i class="fas fa-exclamation-triangle"></i> Busy</button>
        <button class="status" data-type="Shift End"><i class="fas fa-sign-out-alt"></i> Shift End</button>
        <button class="status" data-type="C2C"><i class="fas fa-link"></i> C2C</button>
        <button class="status" data-type="Meeting"><i class="fas fa-users"></i> Meeting</button>
    </div>

    <h3>Schedule</h3>
    <div class="schedule-input">
        <input type="time" id="eventTime">
        <select id="eventType">
            <option value="Start Shift">Start Shift</option>
            <option value="Available">Available</option>
            <option value="Break">Break</option>
            <option value="Busy">Busy</option>
            <option value="C2C">C2C</option>
            <option value="Meal">Meal</option>
            <option value="Meeting">Meeting</option>
            <option value="On Queue">On Queue</option>
            <option value="Shift End">Shift End</option>
        </select>
        <button id="addEvent" class="tooltip">Add Event<span class="tooltip-text">Add a new schedule event</span></button>
        <button id="saveChanges" style="display: none;" class="tooltip">Save Changes<span class="tooltip-text">Save changes to edited event</span></button>
        <button id="cancelChanges" style="display: none;" class="tooltip">Cancel<span class="tooltip-text">Cancel editing</span></button>
    </div>

    <div id="scheduleCards" class="schedule-cards"></div>
    <div id="timeline" class="timeline"></div>

    <button id="openWeekPlanner" class="tooltip">Open Week Planner<span class="tooltip-text">Plan your week across all days</span></button>
    <div id="weekPlannerModal" class="modal">
        <div class="modal-content">
            <span id="closeModal">&times;</span>
            <h3>Week Planner</h3>
            <div class="planner-tabs">
                <button id="dailyTab" class="tab active">Daily Schedule</button>
                <button id="customTab" class="tab">Custom Schedules</button>
            </div>
            <div id="dailyPlanner" class="planner-content">
                <div class="planner-input">
                    <input type="time" id="dailyPlannerEventTime">
                    <select id="dailyPlannerEventType">
                        <option value="Start Shift">Start Shift</option>
                        <option value="Available">Available</option>
                        <option value="Break">Break</option>
                        <option value="Busy">Busy</option>
                        <option value="C2C">C2C</option>
                        <option value="Meal">Meal</option>
                        <option value="Meeting">Meeting</option>
                        <option value="On Queue">On Queue</option>
                        <option value="Shift End">Shift End</option>
                    </select>
                    <button id="addDailyPlannerEvent">Add Event to Day</button>
                </div>
                <div class="planner-instructions">Double-click an event to edit</div>
                <table id="weekTable">
                    <thead><tr><th>Mon</th><th>Tue</th><th>Wed</th><th>Thu</th><th>Fri</th><th>Sat</th><th>Sun</th></tr></thead>
                    <tbody>
                        <tr><td draggable="true" data-day="mon"></td><td draggable="true" data-day="tue"></td><td draggable="true" data-day="wed"></td><td draggable="true" data-day="thu"></td><td draggable="true" data-day="fri"></td><td draggable="true" data-day="sat"></td><td draggable="true" data-day="sun"></td></tr>
                    </tbody>
                </table>
            </div>
            <div id="customPlanner" class="planner-content" style="display: none;">
                <div class="planner-input">
                    <input type="time" id="customPlannerEventTime">
                    <select id="customPlannerEventType">
                        <option value="Start Shift">Start Shift</option>
                        <option value="Available">Available</option>
                        <option value="Break">Break</option>
                        <option value="Busy">Busy</option>
                        <option value="C2C">C2C</option>
                        <option value="Meal">Meal</option>
                        <option value="Meeting">Meeting</option>
                        <option value="On Queue">On Queue</option>
                        <option value="Shift End">Shift End</option>
                    </select>
                    <button id="addCustomPlannerEvent">Add Event to Custom</button>
                    <button id="createCustomSchedule">Create New Schedule</button>
                </div>
                <div class="planner-instructions">Double-click an event to edit</div>
                <div id="customSchedulesList"></div>
            </div>
        </div>
    </div>

    <div id="settingsPanel" class="settings-panel">
        <h3 class="theme-header tooltip">Theme<span class="tooltip-text">Switch between light and dark themes</span></h3>
        <button id="lightTheme" class="tooltip">
            <svg class="theme-icon" viewBox="0 0 24 24" fill="#ffff00"><path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83M2 12h4M18 12h4"></path></svg>
            Light<span class="tooltip-text">Switch to light theme</span>
        </button>
        <button id="darkTheme" class="tooltip">
            <svg class="theme-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path></svg>
            Dark<span class="tooltip-text">Switch to dark theme</span>
        </button>

        <details class="accordion">
            <summary class="time-format-header tooltip">Time Format<span class="tooltip-text">Choose 12-hour or 24-hour format</span></summary>
            <select id="timeFormat">
                <option value="12">12-hour (AM/PM)</option>
                <option value="24">24-hour</option>
            </select>
        </details>

        <details class="accordion">
            <summary class="alert-times-header tooltip">Alert Times<span class="tooltip-text">Set alert timings for events</span></summary>
            <table class="alert-settings">
                <tr><th>Alert Type</th><th>Slider</th><th>Value</th></tr>
                <tr><td>Alert Lead Time (mins before)</td><td><input type="range" id="leadTimeSlider" min="0" max="30" step="1"></td><td><input type="number" id="leadTime" min="0" max="30"></td></tr>
                <tr><td>First Warn (mins after)</td><td><input type="range" id="firstWarnSlider" min="0" max="30" step="1"></td><td><input type="number" id="firstWarn" min="0" max="30"></td></tr>
                <tr><td>Second Warn (mins after)</td><td><input type="range" id="secondWarnSlider" min="0" max="30" step="1"></td><td><input type="number" id="secondWarn" min="0" max="30"></td></tr>
            </table>
        </details>

        <details class="accordion">
            <summary class="sounds-header tooltip">Sounds<span class="tooltip-text">Configure sound alerts</span></summary>
            <label><input type="checkbox" id="enableSounds"> Enable Sounds <svg class="speaker" viewBox="0 0 24 24"><path d="M3 9v6h4l5 5V4l-5 5H3z"></path></svg></label>
            <table class="sound-settings">
                <tr><th>Alert Type</th><th>Enable</th><th>Sound Pattern</th><th>Volume</th><th>Preview</th></tr>
                <tr data-alert="leadTime"><td>Lead Time</td><td><input type="checkbox" class="sound-enable" data-alert="leadTime"></td><td><select class="sound-pattern" data-alert="leadTime"><option value="double">Double Beep</option><option value="single">Single Beep</option><option value="triple">Triple Beep</option><option value="chime">Chime</option></select></td><td><input type="range" class="sound-volume" data-alert="leadTime" min="0" max="1" step="0.1"></td><td><button class="preview-sound" data-alert="leadTime">Play</button></td></tr>
                <tr data-alert="atEvent"><td>At Event</td><td><input type="checkbox" class="sound-enable" data-alert="atEvent"></td><td><select class="sound-pattern" data-alert="atEvent"><option value="single">Single Beep</option><option value="double">Double Beep</option><option value="triple">Triple Beep</option><option value="chime">Chime</option></select></td><td><input type="range" class="sound-volume" data-alert="atEvent" min="0" max="1" step="0.1"></td><td><button class="preview-sound" data-alert="atEvent">Play</button></td></tr>
                <tr data-alert="firstWarn"><td>First Warn</td><td><input type="checkbox" class="sound-enable" data-alert="firstWarn"></td><td><select class="sound-pattern" data-alert="firstWarn"><option value="triple">Triple Beep</option><option value="single">Single Beep</option><option value="double">Double Beep</option><option value="chime">Chime</option></select></td><td><input type="range" class="sound-volume" data-alert="firstWarn" min="0" max="1" step="0.1"></td><td><button class="preview-sound" data-alert="firstWarn">Play</button></td></tr>
                <tr data-alert="secondWarn"><td>Second Warn</td><td><input type="checkbox" class="sound-enable" data-alert="secondWarn"></td><td><select class="sound-pattern" data-alert="secondWarn"><option value="chime">Chime</option><option value="single">Single Beep</option><option value="double">Double Beep</option><option value="triple">Triple Beep</option></select></td><td><input type="range" class="sound-volume" data-alert="secondWarn" min="0" max="1" step="0.1"></td><td><button class="preview-sound" data-alert="secondWarn">Play</button></td></tr>
            </table>
            <input type="file" id="soundUpload" accept="audio/*">
            <button id="uploadSound" class="tooltip">Upload Sound<span class="tooltip-text">Add custom sound to sounds folder</span></button>
        </details>

        <details class="accordion">
            <summary class="click-sounds-header tooltip">Click Sounds<span class="tooltip-text">Enable and adjust click sounds</span></summary>
            <label><input type="checkbox" id="enableClicks"> Enable Click Sounds</label>
            <label>Click Volume: <input type="range" id="clickVolume" min="0" max="1" step="0.1"></label>
            <select id="clickSoundSelect">
                <option value="click.mp3">Click</option>
                <option value="beep.mp3">Beep</option>
            </select>
            <button id="clickPreview" class="tooltip">Preview Click<span class="tooltip-text">Preview click sound</span></button>
        </details>

        <details class="accordion">
            <summary class="sidebar-mode-header tooltip">Sidebar Mode<span class="tooltip-text">Enable sidebar layout</span></summary>
            <label><input type="checkbox" id="sidebarMode"> Enable Sidebar Mode</label>
            <button id="pinSidebar" class="tooltip">Pin to Sidebar<span class="tooltip-text">Pin via browser settings</span></button>
            <button id="installApp" class="tooltip">Install as App<span class="tooltip-text">Install via browser menu</span></button>
        </details>

        <details class="accordion">
            <summary class="data-management-header tooltip">Data Management<span class="tooltip-text">Import/export or reset data</span></summary>
            <div class="import-container">
                <label>Import Schedule: <input type="file" id="importFile" accept=".json"></label>
                <button id="importSchedule" class="tooltip">Import<span class="tooltip-text">Import schedule from JSON file</span></button>
            </div>
            <button id="exportSchedule" class="tooltip">Export Schedule<span class="tooltip-text">Export schedule to JSON file</span></button>
            <button id="resetApp" class="tooltip">Reset App<span class="tooltip-text">Reset all data and reload</span></button>
        </details>

        <details class="accordion">
            <summary class="time-zone-header tooltip">Time Zone<span class="tooltip-text">Select your time zone</span></summary>
            <select id="timeZone">
                <option value="America/Phoenix">MST (Arizona)</option>
                <option value="America/Los_Angeles">PST (Pacific)</option>
                <option value="America/Chicago">CST (Central)</option>
                <option value="America/New_York">EST (Eastern)</option>
                <option value="UTC">UTC</option>
                <option value="Asia/Kuala_Lumpur">Kuala Lumpur</option>
            </select>
            <span id="currentTimeZone">Current: America/Phoenix</span>
            <span id="timeZonePreview"></span>
        </details>
    </div>
</body>
</html>